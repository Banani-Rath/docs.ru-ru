---
title: "Не удается обратиться к члену экземпляра класса из совместно используемого метода или совместно используемого инициализатора без явного указания экземпляра этого класса | Microsoft Docs"
ms.custom: ""
ms.date: "11/24/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vbc30369"
  - "bc30369"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "BC30369"
  - "Shared"
ms.assetid: 39d9466b-c1f3-4406-91a5-3d6c52d23a3d
caps.latest.revision: 9
caps.handback.revision: 9
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
translationtype: Human Translation
---
# Не удается обратиться к члену экземпляра класса из совместно используемого метода или совместно используемого инициализатора без явного указания экземпляра этого класса
[!INCLUDE[vs2017banner](../../../csharp/includes/vs2017banner.md)]

Предпринята попытка сослаться на член класса, не являющийся общим, из общей процедуры.  В следующем примере показана такая ситуация.  
  
```  
Class sample  
    Public x as Integer  
    Public Shared Sub setX()  
        x = 10  
    End Sub  
End Class  
```  
  
 В предыдущем примере оператор присваивания `x = 10` вызывает это сообщение об ошибке.  Это происходит потому, что общая процедура пытается получить доступ к переменной экземпляра.  
  
 Переменная `x` является членом экземпляра, поскольку она не объявлена как [Shared](../../../visual-basic/language-reference/modifiers/shared.md).  Каждый экземпляр класса `sample` содержит собственные переменные `x`.  Когда один экземпляр задает или изменяет значение `x`, это не влияет на значение `x` в других экземплярах.  
  
 Однако процедура `setX` является `Shared` для всех экземпляров класса `sample`.  Это означает, что она не связана с каким\-либо экземпляром класса. Она работает независимо от отдельных экземпляров.  Поскольку она не связана с конкретным экземпляром, `setX` не может получить доступ к переменной экземпляра.  Она должна работать только с `Shared` переменными.  Когда `setX` задает или изменяет значение общей переменной, это новое значение становится доступным всем экземплярам класса.  
  
 **Идентификатор ошибки:** BC30369  
  
### Чтобы исправить эту ошибку  
  
1.  Решите, хотите ли вы, чтобы член был общим для всех экземпляров класса, или пусть он хранится отдельно для каждого экземпляра.  
  
2.  Если требуется одна копия элемента для всех экземпляров, добавьте к объявлению члена ключевое слово `Shared`.  Оставьте ключевое слово `Shared` в объявлении процедуры.  
  
3.  Если требуется отдельная копия члена для каждого экземпляра, не указывайте `Shared` в объявлении члена.  Удалите ключевое слово `Shared` из объявления процедуры.  
  
## См. также  
 [Shared](../../../visual-basic/language-reference/modifiers/shared.md)