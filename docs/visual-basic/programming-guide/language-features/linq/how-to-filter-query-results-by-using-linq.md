---
title: "Практическое руководство. Фильтрование результатов запроса с помощью LINQ (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "11/24/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "фильтрация [LINQ в Visual Basic]"
  - "фильтрация [Visual Basic]"
  - "фильтрация данных [LINQ в Visual Basic]"
  - "фильтрация данных [Visual Basic]"
  - "запросы [LINQ в Visual Basic], фильтрация результатов"
  - "запросы [LINQ в Visual Basic], разделы практического руководства"
  - "примеры запросов [Visual Basic]"
  - "запрос баз данных [LINQ]"
ms.assetid: ef103092-9bed-4134-97f4-2db696e83c12
caps.latest.revision: 6
caps.handback.revision: 6
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
translationtype: Human Translation
---
# Практическое руководство. Фильтрование результатов запроса с помощью LINQ (Visual Basic)
[!INCLUDE[vs2017banner](../../../../csharp/includes/vs2017banner.md)]

Запросы, интегрированные в язык программирования \(Language\-Integrated Query, LINQ\), упрощают доступ к содержимому базы данных и обеспечивают выполнение запросов.  
  
 Пример демонстрирует создание нового приложения, которое выполняет запросы к базе данных SQL Server и фильтрует результаты по определенному значению с помощью предложения `Where`.  Дополнительные сведения см. в разделе [Предложение Where](../../../../visual-basic/language-reference/queries/where-clause.md).  
  
 В примерах этого раздела используется учебная база данных "Борей".  При отсутствии учебной базы данных "Борей" на компьютере разработчика ее можно загрузить с веб\-узла [Центра загрузки Майкрософт](http://go.microsoft.com/fwlink/?LinkID=98088).  Подробные инструкции см. в разделе [Загрузка образцов баз данных](../Topic/Downloading%20Sample%20Databases.md).  
  
 [!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note_settings_general_md.md)]  
  
### Создание подключения к базе данных  
  
1.  В Visual Studio откройте **обозреватель серверов** или **обозреватель баз данных**. Для этого в меню **Вид** выберите пункт **Обозреватель серверов** или **Обозреватель баз данных**.  
  
2.  В **обозревателе серверов** или **обозревателе баз данных** щелкните правой кнопкой мыши **Подключения данных**, а затем выберите команду **Добавить подключение**.  
  
3.  Укажите допустимое подключение к учебной базе данных "Northwind".  
  
### Добавление проекта, содержащего файл LINQ\-SQL  
  
1.  В меню **Файл** окна Visual Studio выберите команду **Создать** и щелкните **Проект**.  Выберите **Приложение Windows Forms** в качестве типа проекта Visual Basic.  
  
2.  В меню **Проект** выберите команду **Добавить новый элемент**.  Выберите шаблон элемента **Классы LINQ\-SQL**.  
  
3.  Назовите файл `northwind.dbml`.  Нажмите кнопку **Добавить**.  Будет открыт объектно\-реляционный конструктор для файла Northwind.dbml.  
  
### Добавление таблицы к запросу в объектно\-реляционном конструкторе  
  
1.  В представлении **Обозреватель серверов** или **Обозреватель баз данных** разверните подключение к базе данных "Northwind".  Разверните папку **Таблицы**.  
  
     Если реляционный конструктор объектов закрыт, откройте его снова, дважды щелкнув файл northwind.dbml, который был добавлен ранее.  
  
2.  Щелкните таблицу "Клиенты" и перетащите ее в левую область конструктора.  Щелкните таблицу "Заказы" и перетащите ее в левую область конструктора.  
  
     Для проекта в конструкторе создаются новые объекты `Customer` и `Order`.  Обратите внимание, что конструктор автоматически обнаруживает связи между таблицами и создает дочерние свойства для связанных объектов.  Например, функция IntelliSense покажет, что в объекте `Customer` имеется свойство `Orders` для всех заказов, связанных с клиентом.  
  
3.  Сохраните изменения и закройте конструктор.  
  
4.  Сохраните проект.  
  
### Добавление кода в запрос к базе данных и отображение результатов  
  
1.  С **панели элементов** перетащите элемент управления <xref:System.Windows.Forms.DataGridView> в заданную по умолчанию форму Windows Forms для проекта \(Form1\).  
  
2.  Дважды щелкните Form1, чтобы добавить код в событие формы `Load`.  
  
3.  При добавлении таблиц объектно\-реляционный конструктор добавляет в проект объект <xref:System.Data.Linq.DataContext>.  Этот объект содержит код, необходимый для обращения к этим таблицам, в дополнение к отдельным объектам и коллекциям для каждой таблицы.  Объекту <xref:System.Data.Linq.DataContext> для проекта присвоено имя на основе имени файла .dbml.  Для данного проекта объект <xref:System.Data.Linq.DataContext> называется `northwindDataContext`.  
  
     Можно создать экземпляр <xref:System.Data.Linq.DataContext> в коде и запросить таблицы, указанные реляционным конструктором объектов.  
  
     Добавьте следующий код к событию `Load` для запроса к таблицам, которые отображаются как свойства контекста данных.  Запрос фильтрует результаты и возвращает только клиентов, которые находятся в городе `London`.  
  
     [!CODE [VbLINQToSQLHowTos#11](../CodeSnippet/VS_Snippets_VBCSharp/VbLINQtoSQLHowTos#11)]  
  
4.  Нажмите клавишу F5, чтобы запустить проект и просмотреть результаты.  
  
5.  Ниже приведены другие фильтры, которые можно попробовать.  
  
     [!CODE [VbLINQToSQLHowTos#12](../CodeSnippet/VS_Snippets_VBCSharp/VbLINQtoSQLHowTos#12)]  
  
## См. также  
 [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)   
 [Запросы](../../../../visual-basic/language-reference/queries/queries.md)   
 [LINQ to SQL](../Topic/LINQ%20to%20SQL.md)   
 [Методы DataContext \(реляционный конструктор объектов\)](/visual-studio/data-tools/datacontext-methods-o-r-designer)   
 [Пошаговое руководство. Создание классов LINQ to SQL \(реляционный конструктор объектов\)](../Topic/Walkthrough:%20Creating%20LINQ%20to%20SQL%20Classes%20\(O-R%20Designer\).md)