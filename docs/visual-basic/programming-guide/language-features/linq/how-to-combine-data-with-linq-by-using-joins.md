---
title: "Практическое руководство. Объединение данных с помощью LINQ с использованием соединений (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "11/24/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "Group Join - предложение [Visual Basic]"
  - "Join - предложение [LINQ в Visual Basic]"
  - "присоединение [LINQ в Visual Basic]"
  - "соединения [LINQ в Visual Basic]"
  - "запросы [LINQ в Visual Basic], разделы практического руководства"
  - "запросы [LINQ в Visual Basic], соединения"
ms.assetid: 5b00a478-035b-41c6-8918-be1a97728396
caps.latest.revision: 13
caps.handback.revision: 13
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
translationtype: Human Translation
---
# Практическое руководство. Объединение данных с помощью LINQ с использованием соединений (Visual Basic)
[!INCLUDE[vs2017banner](../../../../csharp/includes/vs2017banner.md)]

Visual Basic предоставляет предложения запроса `Join` и `Group Join` для объединения содержимого нескольких коллекций на основе общих значений между коллекциями.  Эти значения называются значениями *ключа*.  Разработчики, знакомые с основными понятиями реляционных баз данных, будет воспринимать предложение `Join` как INNER JOIN и предложение `Group Join` фактически как LEFT OUTER JOIN.  
  
 В этом разделе в примерах демонстрируются несколько способов для объединения данных с помощью предложений запроса `Join` и `Group Join`.  
  
## Создание проекта и добавление данных\-образцов  
  
#### Создание проекта, содержащего данные\-образцы и типы  
  
1.  Чтобы запустить примеры в этом разделе, откройте Visual Studio и добавьте новый проект консольного приложения Visual Basic.  Дважды щелкните файл Module1.vb, созданный Visual Basic.  
  
2.  Образцы в этом разделе используют типы `Person` и `Pet` и данные из следующего примера кода.  Скопируйте этот код в модуль `Module1`, созданный Visual Basic по умолчанию.  
  
     [!CODE [VbLINQHowTos#1](../CodeSnippet/VS_Snippets_VBCSharp/VbLINQHowTos#1)]  
    [!CODE [VbLINQHowTos#2](../CodeSnippet/VS_Snippets_VBCSharp/VbLINQHowTos#2)]  
  
## Выполнение внутреннего соединения с помощью предложения Join  
 Внутреннее соединение объединяет данные из двух коллекций.  Включены элементы, для которых указанные ключевые значения совпадают.  Все элементы из любой из двух коллекций, у которых нет соответствующего элемента в другой коллекции, исключаются.  
  
 В Visual Basic LINQ поддерживает два параметра для выполнения внутреннего соединения: неявное соединение и явное соединение.  
  
 Неявное соединение задает коллекции для объединения в предложении `From` и определяет соответствующие ключевые поля в предложении `Where`.  Visual Basic неявно объединяет две коллекции, основанные на указанных ключевых полях.  
  
 Явное соединение можно указать с помощью предложения `Join` при необходимости явно указать, какие ключевые поля использовать для объединения.  В этом случае предложение `Where` по\-прежнему может быть использовано для фильтрации результатов запроса.  
  
#### Выполнение внутреннего соединения с помощью предложения Join  
  
1.  Добавьте следующий код в модуль `Module1` проекта, чтобы просмотреть примеры о неявных и явных способах внутреннего соединения.  
  
     [!CODE [VbLINQHowTos#4](../CodeSnippet/VS_Snippets_VBCSharp/VbLINQHowTos#4)]  
  
## Выполнение левого внешнего соединения с помощью предложения Group Join  
 Левое внешнее соединение включает все элементы из левосторонней коллекции соединения и только совпадающие значения из правосторонней коллекции соединения.  Все элементы из правосторонней коллекции соединения, у которых нет соответствующего элемента в левосторонней коллекции, исключаются из результатов запроса.  
  
 Предложение `Group Join` выполняет, в сущности, левое внешнее соединение.  Различием между левым внешним соединением и предложением `Group Join` является то, что предложение `Group Join` возвращает соответствующие элементы из правосторонней коллекции объединения для каждого элемента в левосторонней коллекции.  В реляционной базе данных левое внешнее соединение возвращает несгруппированный результат, в котором каждый элемент результата запроса содержит найденные элементы из обеих коллекций в соединении.  В этом случае элементы из левосторонней коллекции соединения повторяются для каждого соответствующего элемента из правосторонней коллекции.  Как это выглядит можно увидеть после выполнения следующей процедуры.  
  
 Можно получить результаты запроса `Group Join` в виде несгруппированного результата, расширяя запрос, чтобы объект возвращался для каждого сгруппированного результата запроса.  Чтобы выполнить это, необходимо убедиться, что выполняется запрос для метода `DefaultIfEmpty` сгруппированной коллекции.  Это гарантирует, что элементы из левосторонней коллекции соединения будут включены в результат запроса, даже если они не имеют совпадающих элементов из правосторонней коллекции.  Можно добавить код к запросу для предоставления результирующего значения по умолчанию при отсутствии совпадающих значений из правосторонней коллекции объединения.  
  
#### Выполнение левого внешнего соединения с помощью предложения Group Join  
  
1.  Добавьте следующий код в модуль `Module1` проекта, чтобы просмотреть примеры сгруппированного левого внешнего соединения и несгруппированного левого внешнего соединения.  
  
     [!CODE [VbLINQHowTos#3](../CodeSnippet/VS_Snippets_VBCSharp/VbLINQHowTos#3)]  
  
## Выполнение соединения с помощью составного ключа  
 Можно использовать ключевое слово `And` в предложении `Join` или `Group Join` для идентификации нескольких ключевых полей для использования при определении соответствия значений из соединяемых коллекций.  Ключевое слово `And` определяет, что все указанные ключевые поля должны соответствовать элементам, которые будут присоединены.  
  
#### Выполнение соединения с помощью составного ключа  
  
1.  Добавьте следующий код в модуль `Module1` проекта, чтобы просмотреть примеры соединения, в которых используется составной ключ.  
  
     [!CODE [VbLINQHowTos#5](../CodeSnippet/VS_Snippets_VBCSharp/VbLINQHowTos#5)]  
  
## Запустите код  
  
#### Добавление кода для выполнения примеров  
  
1.  Чтобы выполнить примеры в этом разделе, замените `Sub Main` в модуле `Module1` в проекте на следующий код.  
  
     [!CODE [VbLINQHowTos#6](../CodeSnippet/VS_Snippets_VBCSharp/VbLINQHowTos#6)]  
  
2.  Нажмите клавишу F5 для запуска примеров.  
  
## См. также  
 [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)   
 [Знакомство с LINQ в Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)   
 [Предложение Join](../../../../visual-basic/language-reference/queries/join-clause.md)   
 [Предложение Group Join](../../../../visual-basic/language-reference/queries/group-join-clause.md)   
 [Предложение From](../../../../visual-basic/language-reference/queries/from-clause.md)   
 [Предложение Where](../../../../visual-basic/language-reference/queries/where-clause.md)   
 [Запросы](../../../../visual-basic/language-reference/queries/queries.md)   
 [Преобразования данных с помощью LINQ \(C\#\)](../../../../csharp/programming-guide/concepts/linq/data-transformations-with-linq.md)