---
title: "Практическое руководство. Группировка результатов запросов (Руководство по программированию на C#) | Microsoft Docs"
ms.custom: ""
ms.date: "11/24/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-csharp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "CSharp"
helpviewer_keywords: 
  - "примеры предложения group [LINQ в C#]"
  - "группы [LINQ в C#]"
  - "запросы [LINQ в C#], группирование"
  - "выражения запросов [LINQ в C#], группирование"
ms.assetid: ee981053-3392-4245-a8c2-b3730211da0d
caps.latest.revision: 19
caps.handback.revision: 19
author: "BillWagner"
ms.author: "wiwagn"
manager: "wpickett"
translationtype: Human Translation
---
# Практическое руководство. Группировка результатов запросов (Руководство по программированию на C#)
[!INCLUDE[vs2017banner](../../../csharp/includes/vs2017banner.md)]

Группирование — одна из самых эффективных функций [!INCLUDE[vbteclinq](../../../csharp/includes/vbteclinq_md.md)].  В следующих примерах демонстрируются различные способы группирования данных:  
  
-   По отдельному свойству.  
  
-   По первой букве строкового свойства.  
  
-   По расчетному числовому диапазону.  
  
-   По логическому предикату или другому выражению.  
  
-   По составному ключу.  
  
 Кроме того, два последних запроса передают свои результаты в новый анонимный тип, содержащий только имя и фамилию студента.  Дополнительные сведения см. в разделе [Предложение group](../../../csharp/language-reference/keywords/group-clause.md).  
  
## Пример  
 Во всех примерах в данном разделе используются следующие вспомогательные классы и источники данных.  
  
 [!CODE [csProgGuideLINQ#15](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideLINQ#15)]  
  
## Пример  
 В следующем примере показывается группировка элементов источника с помощью использования отдельного свойства элемента в качестве ключа группы.  В данном случае в качестве ключа используется `string`, фамилия учащегося.  Для ключа можно также использовать подстроку.  При операции группирования используется компаратор проверки на равенство, используемый по умолчанию для данного типа.  
  
 Вставьте приведенный ниже метод в класс `StudentClass`.  Измените оператор вызова в методе `Main` на `sc.GroupBySingleProperty()`.  
  
 [!CODE [csProgGuideLINQ#17](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideLINQ#17)]  
  
## Пример  
 В следующем примере показывается группировка элементов источника, когда в качестве ключа группы используется не свойство объекта.  В данном случае в качестве ключа используется первая буква фамилии учащегося.  
  
 Вставьте приведенный ниже метод в класс `StudentClass`.  Измените оператор вызова в методе `Main` на `sc.GroupBySubstring()`.  
  
 [!CODE [csProgGuideLINQ#18](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideLINQ#18)]  
  
## Пример  
 В следующем примере показывается группировка элементов источника с помощью использования числового диапазона в качестве ключа группы.  Затем запрос передает результаты в анонимный тип, содержащий только имя и фамилию, а также диапазон процентилей, к которому принадлежит студент.  Использование анонимного типа объясняется тем, что для отображения результатов не требуется использовать полный объект `Student`.  `GetPercentile` — это вспомогательная функция, которая вычисляет процент на основе средних результатов учащихся.  Метод возвращает целое число в диапазоне от 0 до 10.  
  
 [!CODE [csProgGuideLINQ#50](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideLINQ#50)]  
  
 Вставьте приведенный ниже метод в класс `StudentClass`.  Измените оператор вызова в методе `Main` на `sc.GroupByRange()`.  
  
 [!CODE [csProgGuideLINQ#19](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideLINQ#19)]  
  
## Пример  
 В следующем примере показывается группировка элементов источника с помощью выражения логического сравнения.  В этом примере логическое выражение проверяет значение среднего экзаменационного результата учащегося, превосходит ли оно 75 баллов.  Как и в предыдущих примерах, результаты передаются в анонимный тип, поскольку весь элемент источника не требуется.  Обратите внимание на то, что свойства в анонимном типе становятся свойствами в члене `Key`, а при выполнении запроса доступ к ним можно получить по имени.  
  
 Вставьте приведенный ниже метод в класс `StudentClass`.  Измените оператор вызова в методе `Main` на `sc.GroupByBoolean()`.  
  
 [!CODE [csProgGuideLINQ#20](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideLINQ#20)]  
  
## Пример  
 В следующем примере показано, как использовать анонимный тип для инкапсуляции ключа, содержащего несколько значений.  В данном случае в качестве первого значения ключа используется первая буква фамилии учащегося.  Второе значение ключа является логическим и указывает, набрал ли учащийся более 85 баллов на первом экзамене.  Группы можно сортировать по любому из свойств в данном ключе.  
  
 Вставьте приведенный ниже метод в класс `StudentClass`.  Измените оператор вызова в методе `Main` на `sc.GroupByCompositeKey()`.  
  
 [!CODE [csProgGuideLINQ#21](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideLINQ#21)]  
  
## Компиляция кода  
 Копируйте и вставьте каждый метод, подлежащий проверке, в класс `StudentClass`.  Добавьте оператор вызова для метода в метод `Main` и нажмите клавишу F5.  
  
 Настраивая данные методы для собственного приложения, важно помнить, что для LINQ требуется [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] версии 3.5 или 4 и что проект должен содержать ссылку на библиотеку System.Core.dll и директиву using для библиотеки System.Linq.  Типа LINQ to SQL, LINQ to XML и LINQ to DataSet требуют дополнительных директив using и ссылок.  Дополнительные сведения см. в разделе [How to: Create a LINQ Project](../Topic/How%20to:%20Create%20a%20LINQ%20Project.md).  
  
## См. также  
 <xref:System.Linq.Enumerable.GroupBy%2A>   
 <xref:System.Linq.IGrouping%602>   
 [Выражения запросов LINQ](../../../csharp/programming-guide/linq-query-expressions/index.md)   
 [Предложение group](../../../csharp/language-reference/keywords/group-clause.md)   
 [Анонимные типы](../../../csharp/programming-guide/classes-and-structs/anonymous-types.md)   
 [Практическое руководство. Вложенный запрос в операции группирования](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-a-subquery-on-a-grouping-operation.md)   
 [Практическое руководство. Создание вложенной группы](../../../csharp/programming-guide/linq-query-expressions/how-to-create-a-nested-group.md)   
 [Grouping Data](../../../visual-basic/programming-guide/concepts/linq/grouping-data.md)