---
title: "Преимущества универсальных шаблонов (Руководство по программированию на C#) | Microsoft Docs"
ms.custom: ""
ms.date: "11/24/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-csharp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "CSharp"
helpviewer_keywords: 
  - "универсальные шаблоны [C#], преимущества"
ms.assetid: 80f037cd-9ea7-48be-bfc1-219bfb2d4277
caps.latest.revision: 23
caps.handback.revision: 23
author: "BillWagner"
ms.author: "wiwagn"
manager: "wpickett"
translationtype: Human Translation
---
# Преимущества универсальных шаблонов (Руководство по программированию на C#)
[!INCLUDE[vs2017banner](../../../csharp/includes/vs2017banner.md)]

Универсальные шаблоны предоставляют решение для ограничения более ранних версий среды CLR и языка C\#, в которых обобщения достигались за счет приведения типов к универсальному базовому типу <xref:System.Object> и из него.  Путем создания универсального класса можно создать коллекцию, которая была бы строго типизирована во время компиляции.  
  
 Ограничения, возникающие при использовании неуниверсальных классов коллекции, можно продемонстрировать на примере написания короткой программы, использующей класс коллекции <xref:System.Collections.ArrayList> из библиотеки классов платформы .NET Framework.  <xref:System.Collections.ArrayList> — это очень удобный класс коллекции, который можно использовать без изменений для любых ссылочных типов или типов значений.  
  
 [!CODE [csProgGuideGenerics#4](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideGenerics#4)]  
  
 Однако за удобство приходится платить.  Любые ссылки или типы значения, добавляемые к классу коллекции <xref:System.Collections.ArrayList>, неявно приводятся к <xref:System.Object>.  Если в качестве элементов выступают типы значений, то для них необходимо выполнить упаковку\-преобразование при добавлении к списку и распаковку\-преобразование при извлечении из списка.  Операции приведения, упаковки\-преобразования и распаковки\-преобразования снижают производительность. Влияние операций упаковки\-преобразования и распаковки\-преобразования в сценариях обработки больших коллекций может быть весьма значительным.  
  
 Еще одно ограничение состоит в отсутствии проверки типа во время компиляции. Поскольку класс коллекции <xref:System.Collections.ArrayList> приводит все к типу <xref:System.Object>, невозможно предотвратить выполнение клиентским кодом во время компиляции действий, подобных следующим:  
  
 [!CODE [csProgGuideGenerics#5](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideGenerics#5)]  
  
 Несмотря на то, что комбинирование строк и `ints` в единый класс коллекции <xref:System.Collections.ArrayList> вполне допустимо, а иногда и специально выполняется \(при создании разнородной коллекции\), во многих случаях это может привести к ошибке программы, которую можно будет обнаружить только при выполнении.  
  
 В версиях языка C\# 1.0 и 1.1 можно избежать неприятностей, вызванных использованием обобщенного кода в классах коллекции библиотеки базового класса платформы .NET Framework только путем написания пользовательских коллекций особого типа.  Конечно, пользователь теряет преимущества обобщения из\-за того, что такие классы можно использовать только для одного типа данных, и необходимо переписывать класс для каждого типа сохраняемых данных.  
  
 Что действительно необходимо для класса коллекции <xref:System.Collections.ArrayList> и других подобных классов — это возможность указать для каждого отдельного экземпляра в клиентском коде определенный тип данных, который они должны использовать.  Это устранит необходимость приведения к типу `T:System.Object` и даст компилятору возможность проверить тип.  Другими словами, классу коллекции <xref:System.Collections.ArrayList> необходим параметр типа.  Это как раз то, что имеется в универсальном шаблоне.  В универсальном шаблоне коллекции <xref:System.Collections.Generic.List%601> в пространстве имен `N:System.Collections.Generic` та же операция добавления элементов в коллекцию выглядит следующим образом:  
  
 [!CODE [csProgGuideGenerics#6](../CodeSnippet/VS_Snippets_VBCSharp/csProgGuideGenerics#6)]  
  
 Единственным различием в клиентском коде между <xref:System.Collections.Generic.List%601> и <xref:System.Collections.ArrayList> является аргумент типа в разделе объявления и создания экземпляра.  Благодаря этому небольшому усложнению кода можно создать список, который будет не только безопаснее, чем <xref:System.Collections.ArrayList>, но и существенно быстрее, особенно если элементами списка являются типы значений.  
  
## См. также  
 <xref:System.Collections.Generic>   
 [Руководство по программированию на C\#](../../../csharp/programming-guide/index.md)   
 [Введение в универсальные шаблоны](../../../csharp/programming-guide/generics/introduction-to-generics.md)   
 [Упаковка–преобразование и распаковка–преобразование](../../../csharp/programming-guide/types/boxing-and-unboxing.md)   
 [Практические рекомендации по работе с коллекциями](http://go.microsoft.com/fwlink/?LinkId=112403)